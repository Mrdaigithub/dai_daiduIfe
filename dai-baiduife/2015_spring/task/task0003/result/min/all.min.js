"use strict";!function(){function e(e,t){var n=JSON.parse(localStorage.getItem("localData"));if(e){for(var l=0;l<n.length;l++)if(n[l].folderName===t){n.splice(l,1),localStorage.setItem("localData",JSON.stringify(n));break}}else{console.log(t);for(var l=0;l<n.length;l++)for(var a=0;a<n[l].fileNames.length;a++)if(n[l].fileNames[a]===t)return n[l].fileNames.splice(a,1),localStorage.setItem("localData",JSON.stringify(n)),0}}function t(e){var t=h.cloneNode(!0);t.children[0].children[0].innerText=e,e=null,i.appendChild(t),m.style.display="none"}function n(e){var t=v.cloneNode(!0);t.children[0].innerText=e,null===N?alert("请先选中要添加task的文件夹~"):"H4"===N.nodeName?N.parentNode.children[1].appendChild(t):"LI"===N.nodeName&&N.parentNode.appendChild(t),e=null,m.style.display="none"}function l(e,t){var n=v.cloneNode(!0);n.children[0].innerText=e,t.children[1].appendChild(n)}function a(){for(var e=0;e<w.length;e++)if(N.children[0].innerText===w[e].folderName)return e}function r(e,t){if(null!==w)if(e){for(var n=0;n<w.length;n++)if(w[n].folderName===t)return!0}else for(var n=0;n<w.length;n++)for(var l=0;l<w[n].fileNames.length;l++)if(w[n].fileNames[l]===t)return!0;return!1}var o=document,d=o.getElementsByClassName("tasklist"),i=o.getElementById("taskBox"),s=o.getElementsByClassName("main")[0],g=o.getElementsByClassName("middle")[0],c=o.getElementsByClassName("addBtn"),y=o.getElementsByClassName("title")[0],N=null,p=y.children[0];s.style.height=window.innerHeight-60+"px",c[1].style.width=window.getComputedStyle(g,null).width||g.currentStyle.width,c[1].style.width=g.innerWidth,window.addEventListener("resize",function(){s.style.height=window.innerHeight-60+"px",console.log(window.getComputedStyle(g,null).width),c[1].style.width=window.getComputedStyle(g,null).width||g.currentStyle.width},!1),i.addEventListener("click",function(t){var n=window.event||t;"closeBtn"===n.target.className&&"H4"===n.target.parentNode.nodeName?confirm("Are you sure ?")&&(n.target.parentNode.parentNode.parentNode.removeChild(n.target.parentNode.parentNode),e(!0,n.target.parentNode.children[0].innerText)):"closeBtn"===n.target.className&&"LI"===n.target.parentNode.nodeName?confirm("Are you sure ?")&&(n.target.parentNode.parentNode.removeChild(n.target.parentNode),e(!1,n.target.parentNode.children[0].innerText)):("H4"===n.target.nodeName||"LI"===n.target.nodeName||"H4"===n.target.parentNode.nodeName||"LI"===n.target.parentNode.nodeName)&&(N&&(N.style.backgroundColor=null),"H4"===n.target.parentNode.nodeName?(n.target.parentNode.style.backgroundColor="rgb(255,255,255)",N=n.target.parentNode):"LI"===n.target.parentNode.nodeName?(n.target.parentNode.style.backgroundColor="rgb(255,255,255)",N=n.target.parentNode):(n.target.style.backgroundColor="rgb(255,255,255)",N=n.target))},!1),i.addEventListener("dblclick",function(e){var t=window.event||e;"H4"===t.target.nodeName?"block"===t.target.parentNode.children[1].style.display?t.target.parentNode.children[1].style.display="none":t.target.parentNode.children[1].style.display="block":"H4"===t.target.parentNode.nodeName&&("block"===t.target.parentNode.parentNode.children[1].style.display?t.target.parentNode.parentNode.children[1].style.display="none":t.target.parentNode.parentNode.children[1].style.display="block")},!1);var m=o.getElementById("mask"),u=o.getElementById("createTask"),f=o.getElementById("taskName"),h=d[0].cloneNode(!0),v=d[0].getElementsByTagName("ul")[0].getElementsByTagName("li")[0].cloneNode(!0),k=o.createElement("ul");k.style.display="block",h.removeChild(h.children[1]),h.appendChild(k);var w=[];c[0].addEventListener("click",function(){m.style.display="block"},!1),u.addEventListener("click",function(e){var l=window.event||e;if(w=JSON.parse(localStorage.getItem("localData")),null===w&&(w=[]),console.log(w),"noBtn"===l.target.id)m.style.display="none";else if("okBtn"===l.target.id){var o=u.getElementsByTagName("input")[1];if(o.checked){if(r(!0,f.value))return alert("重复创建"),0;t(f.value);var d={folderName:f.value,fileNames:[]};w.push(d)}else{if(r(!1,f.value))return alert("重复创建"),0;if(n(f.value),"H4"===N.nodeName){var i=a();w[i].fileNames.push(f.value)}}}localStorage.setItem("localData",JSON.stringify(w))},!1),function(){var e=JSON.parse(localStorage.getItem("localData"));if(null!==e)for(var n=0;n<e.length;n++){t(e[n].folderName);for(var a=0;a<e[n].fileNames.length;a++)l(e[n].fileNames[a],d[n+1])}}();var E=(o.getElementsByClassName("rightTitle"),o.getElementById("rightTitleName")),B=o.getElementById("inuptTaskName"),b=o.getElementById("rightDateSpan"),C=o.getElementById("inputDate"),I=o.getElementById("rightContentRead"),S=o.getElementById("rightContentWrite"),L=o.getElementById("saveBtn"),T=o.getElementById("btnBox");y.addEventListener("click",function(e){var t=window.event||e;"A"===t.target.nodeName&&(p.style.backgroundColor=null,t.target.style.backgroundColor="rgb(255, 255, 255)",p=t.target)},!1),c[1].addEventListener("click",function(){E.style.display="none",B.style.display="block",b.style.display="none",C.style.display="inline-block",I.style.display="none",S.style.display="block",T.style.display="none"},!1),L.addEventListener("click",function(e){var t=window.event||e;t.target===this.children[1]&&(E.style.display="block",B.style.display="none",b.style.display="inline-block",C.style.display="none",I.style.display="block",S.style.display="none",T.style.display="block")},!1)}();